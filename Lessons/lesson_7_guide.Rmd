---
title: "Lesson 7: Economic Growth"
output:
  pdf_document: 
    toc: true
    toc_depth: 2
    number_sections: true
  html_notebook: default
---

```{r include = FALSE}
# refresh environment
rm(list = ls())

library(mdsr) # utility package for tidyverse
```


## What is Economic Growth?

Economic growth is an increase in living standards, which has traditionally been
measured using Real GDP per capita.

# Chapter Six: Solow Growth Model

## Notation

* L~t~ - Number of workers
* n - growth rate of work force
    + population growth rate
* K~t~ - capital stock
* $\delta$ - depreciation rate
* Y~t~ - output (GDP)
* C~t~ - consumption
* I~t~ - gross investment
    + $C_t = Y_t - I_t$
* $y_t = \frac{Y_t}{L_t}$ - ouput per worker
* $c_t = \frac{C_t}{L_t}$ - consumption per worker
* $k_t = \frac{K_t}{L_t}$ - capital per worker (capital-labor ratio)
* $i_t = \frac{I_t}{L_t}$ - investment per worker

## Big Finding of Solow Model

In the solow model, if the is no productivity growth (an increase in TFP A), then
the economy reaches a steady state. At a steady state y~t~, k~t~, and c~t~ are all
constant while Y, K, and C will grow at the rate n (population growth rate).

## Steady-State of Investment

I~t~ (Investment) serves two main purposes:

1. Expand the size of capital stock (K~t~)
2. Replace depreciated capital ($\delta K_t$)

Since in steady state we know that capital stock K~t~ will grow at the rate n, we
can conclude that $I_t = nK_t + \delta K_t$, which brings per worker steady state
of investment to:
\[
i = (n + \delta)k
\]

## Per-Worker Production Function

Recall that we stated $Y = AF(K, L)$. We can add the time aspect in to get $Y_t =
AF(K_t, L_t)$. Now let's find the per-worker equation:
\[
\frac{Y_t}{L_t} = \frac{AF(K_t, L_t)}{L_t}
\]
\[
\frac{Y_t}{L_t} = A\frac{1}{L_t}F(K_t, L_t)
\]
From here, if the function F(K~t~, L~t~) has constant return to scales we can conclude:
\[
\frac{Y_t}{L_t} = AF(\frac{K_t}{L_t}, \frac{L_t}{L_t})
\]
Which in our notation is
\[
y_t = Af(k_t)
\]

```{r echo = FALSE}
A <- 6
alpha <- 0.3
k_t <- seq(from = 0, to = 200, by = 0.5)
y_t <- A * k_t ^ alpha
data <- data.frame(k_t = k_t, y_t = y_t)

data %>%
  ggplot(aes(x = k_t, y = y_t)) +
  geom_smooth() +
  xlab("Capital-Labor ratio") +
  ylab("Per-worker production") +
  ggtitle("Per worker Production function")
```

## Steady-State of Consumption

We know two things:

1. $C_t = Y_t - I_t$
2. $I_t = (n + \delta)K_t$ at steady state

So we can conlude that $C_t = Y_t - (n + \delta)K_t$ and per worker we get:
\[
c = y - (n + \delta)k
\]
\[
c = Af(k) - (n + \delta)k
\]

If capital increases what happens to production?

* If k increases, then $f(k)$ increases, but at a decreasing rate, so c (consmumption increases)
* If k increases, then $(n + \delta)k$ increases, but at a rate of $(n + \delta)$, so c (consumption decreases)

What happens if we try to maximize consumption? (not related to steady state)

```{r echo = FALSE}
n <- 0.05
delta <- 0.15
data$i <- (n + delta) * k_t

# intecept
steady <- (A / (n + delta)) ^ (1 / (1 - alpha))

# max consumption
maxConsum <- ((n + delta) / (alpha * A)) ^ (1 / (alpha - 1))

data %>%
  ggplot(aes(x = k_t, y = y_t, color = "production")) +
  geom_smooth() +
  geom_smooth(aes(y = i, color = "steady")) +
  geom_vline(xintercept = steady) +
  annotate("text", x = steady - 5, y = 1, label = "K*") +
  geom_vline(xintercept = maxConsum) +
  annotate("text", x = maxConsum + 10, y = 1, label = "Max c") +
  xlab("Capital-Labor ratio") +
  ylab("Per-worker production") +
  ggtitle("Steady State investment vs production")
```

```{r echo = FALSE}
data$c <- data$y_t - data$i

data %>%
  ggplot(aes(x = k_t, y = c)) +
  geom_smooth() +
  xlab("Capital-Labor ratio") +
  ylab("Consumption per worker") +
  ggtitle("Consumption per worker (Diff of production and steady invest)") +
  geom_vline(xintercept = maxConsum) +
  annotate("text", x = maxConsum + 10, y = 1, label = "Max c") +
  scale_x_continuous(limits = c(0, 200))
```
  
The maximum of consumption happens at the value of k with the biggest difference of
y and $(n + \delta)k$. Consumption comes back down to zero where production is equal
to $(n + \delta)k$.

## Reaching the Steady-State
  
  
At steady state let us assume there is no change in TFP (A). We know that in steady
state $I_t = (n + \delta)K_t$ and that Savings = Investment in equilbrium. Let us
define s as the savings rate.
\[
S_t = sY_t
\]
Since we stated savings = investment:
\[
sY_t = (n + \delta)K_t
\]
Which gives us the per worker steady-state condition:
\[
sf(k) = (n + \delta)k
\]
\[
sy = (n + \delta)k
\]

Add in savings rate to compare steady state and actual investment:
```{r echo = FALSE}
s <- 0.2

data$invest <- s * data$y_t

# intecept
steady <- ((s * A) / (n + delta)) ^ (1 / (1 - alpha))

data %>%
  ggplot(aes(x = k_t, y = invest, color = "actual investment")) +
  geom_smooth() +
  geom_smooth(aes(y = i, color = "steady investment")) +
  geom_vline(xintercept = steady) +
  annotate("text", x = steady + 2, y = 1, label = "K*") +
  geom_vline(xintercept = steady - 5) +
  annotate("text", x = steady - 7, y = 1, label = "K (low)") +
  geom_vline(xintercept = steady + 10) +
  annotate("text", x = steady + 12, y = 1, label = "K (high)") +
  xlab("Capital-Labor ratio") +
  ylab("Investment") +
  ggtitle("Steady State investment vs Actual Investment") +
  scale_x_continuous(limits = c(0, 50))
```

When the level of capital is less than $K^*$ (K (low)), then actual investment is greater than
that required for steady state, so the capital-labor ratio incrases until it hits
steady state, which also increases per worker production. In the other case when
the level of capital is greater than $K^*$ (K (high)), then the actual investment is
less than that required for steady state, so the capital-labor ratio decreases until
it hits the steady state, which decrease per worker production.

## Changes to the Solow Model


There are three main factors that change the solow model

1. Changes in TFP (A) change $sf(k)$
2. Cahnges in savings rate (s) change $sf(k)$
3. Changes in the population growth rate (n) change $(n + \delta)k$

### Changes in A

```{r echo = FALSE}
n <- 0.05
A2 <- 4
A3 <- 8
s <- 0.2
data$y_t2 <- A2 * data$k_t ^ alpha
data$invest2 <- s * data$y_t2
data$y_t3 <- A3 * data$k_t ^ alpha
data$invest3 <- s * data$y_t3
data$i <- (n + delta) * k_t

# intercept
steady <- ((s * A) / (n + delta)) ^ (1 / (1 - alpha))
steady2 <- ((s * A2) / (n + delta)) ^ (1 / (1 - alpha))
steady3 <- ((s * A3) / (n + delta)) ^ (1 / (1 - alpha))


data %>%
  ggplot(aes(x = k_t, y = invest, color = "original")) +
  geom_smooth() +
  geom_smooth(aes(y = i, color = "original")) +
  geom_smooth(aes(y = invest2, color = "decrease A")) +
  geom_smooth(aes(y = invest3, color = "increase A")) +
  geom_vline(xintercept = steady, color = "blue") +
  geom_vline(xintercept = steady2, color = "red") +
  geom_vline(xintercept = steady3, color = "green") +
  xlab("Capital-Labor ratio") +
  ylab("Per-worker production") +
  ggtitle("Steady State investment vs Actual Investment") +
  scale_x_continuous(limits = c(0, 50))
```

### Changes in s

```{r echo = FALSE}
s2 <- 0.3
s3 <- 0.15
data$y_t2 <- A * data$k_t ^ alpha
data$invest2 <- s2 * data$y_t2
data$y_t3 <- A * data$k_t ^ alpha
data$invest3 <- s3 * data$y_t3
data$i <- (n + delta) * k_t

# intercept
steady <- ((s * A) / (n + delta)) ^ (1 / (1 - alpha))
steady2 <- ((s2 * A) / (n + delta)) ^ (1 / (1 - alpha))
steady3 <- ((s3 * A) / (n + delta)) ^ (1 / (1 - alpha))


data %>%
  ggplot(aes(x = k_t, y = invest, color = "original")) +
  geom_smooth() +
  geom_smooth(aes(y = i, color = "original")) +
  geom_smooth(aes(y = invest2, color = "increase s")) +
  geom_smooth(aes(y = invest3, color = "decrease s")) +
  geom_vline(xintercept = steady, color = "blue") +
  geom_vline(xintercept = steady2, color = "green") +
  geom_vline(xintercept = steady3, color = "red") +
  xlab("Capital-Labor ratio") +
  ylab("Per-worker production") +
  ggtitle("Steady State investment vs Actual Investment") +
  scale_x_continuous(limits = c(0, 50))
```

### Changes in n

```{r echo = FALSE}
n2 <- 0.1
n3 <- 0.025
data$i2 <- (n2 + delta) * k_t
data$i3 <- (n3 + delta) * k_t

# intercept
steady <- ((s * A) / (n + delta)) ^ (1 / (1 - alpha))
steady2 <- ((s * A) / (n2 + delta)) ^ (1 / (1 - alpha))
steady3 <- ((s * A) / (n3 + delta)) ^ (1 / (1 - alpha))


data %>%
  ggplot(aes(x = k_t, y = invest, color = "original")) +
  geom_smooth() +
  geom_smooth(aes(y = i, color = "original")) +
  geom_smooth(aes(y = i2, color = "increase n")) +
  geom_smooth(aes(y = i3, color = "decrease n")) +
  geom_vline(xintercept = steady, color = "blue") +
  geom_vline(xintercept = steady2, color = "green") +
  geom_vline(xintercept = steady3, color = "red") +
  xlab("Capital-Labor ratio") +
  ylab("Per-worker production") +
  ggtitle("Steady State investment vs Actual Investment") +
  scale_x_continuous(limits = c(0, 50))
```





